"use strict";!function(){const e={form:"ipFilterModal","delete":"ipFilterDeleteModal"};function t(){if(!document.getElementById(e.form)){const t=document.createElement("div");t.id=e.form,t.className="modal fade",t.tabIndex=-1,t.innerHTML=`\n        <div class="modal-dialog">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title" id="${e.form}-title">IP Filter</h5>\n              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n            </div>\n            <div class="modal-body">\n              <form id="${e.form}-form" novalidate>\n                <div class="mb-3">\n                  <label for="${e.form}-ip" class="form-label">IP / CIDR</label>\n                  <input type="text" class="form-control" id="${e.form}-ip" placeholder="e.g. 192.168.1.10 or 192.168.1.0/24" required />\n                  <div class="invalid-feedback">Please enter a valid IPv4 or CIDR.</div>\n                </div>\n                <div class="mb-3">\n                  <label for="${e.form}-status" class="form-label">Status</label>\n                  <select class="form-select" id="${e.form}-status" required>\n                    <option value="allowed">Allowed</option>\n                    <option value="forbidden">Forbidden</option>\n                  </select>\n                  <div class="invalid-feedback">Please select a status.</div>\n                </div>\n                <input type="hidden" id="${e.form}-line" value="" />\n              </form>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>\n              <button type="button" id="${e.form}-save" class="btn btn-primary">Save</button>\n            </div>\n          </div>\n        </div>\n      `,document.body.appendChild(t)}if(!document.getElementById(e["delete"])){const t=document.createElement("div");t.id=e["delete"],t.className="modal fade",t.tabIndex=-1,t.innerHTML=`\n        <div class="modal-dialog modal-dialog-centered">\n          <div class="modal-content">\n            <div class="modal-header">\n              <h5 class="modal-title">Delete Entry</h5>\n              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n            </div>\n            <div class="modal-body">\n              <p id="${e["delete"]}-text" class="mb-0">Are you sure you want to delete this entry?</p>\n            </div>\n            <div class="modal-footer">\n              <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>\n              <button type="button" id="${e["delete"]}-confirm" class="btn btn-danger">Delete</button>\n            </div>\n          </div>\n        </div>\n      `,document.body.appendChild(t)}}function n({title:n,ip:o="",status:l="allowed",line_number:d="",onSubmit:a}){t();const i=document.getElementById(e.form),s=bootstrap.Modal.getOrCreateInstance(i,{backdrop:!0,keyboard:!0}),r=document.getElementById(`${e.form}-title`),m=document.getElementById(`${e.form}-ip`),c=document.getElementById(`${e.form}-status`),u=document.getElementById(`${e.form}-line`),b=document.getElementById(`${e.form}-form`),f=document.getElementById(`${e.form}-save`);r.textContent=n||"IP Filter",m.value=o||"",c.value=l||"allowed",u.value=d||"",b.classList.remove("was-validated");f.onclick=()=>{const e=m.value.trim(),t=c.value,n=u.value?Number(u.value):null;let o=!0;if(function(e){const t=String(e||"").trim();return!!t.match(/^(\d{1,3}\.){3}\d{1,3}(\/(\d|[12]\d|3[0-2]))?$/)&&t.split("/")[0].split(".").map(Number).every((e=>e>=0&&e<=255))}(e)||(o=!1),t||(o=!1),o)try{"function"==typeof a&&a({ip:e,status:t,line_number:n}),s.hide()}catch(l){console.error("[ipModal] submit error:",l)}else b.classList.add("was-validated")},s.show()}window.IpModal={openAdd(e){n({title:"Add IP Filter",onSubmit:e})},openEdit(e,t){n({title:"Modify IP Filter",...e,onSubmit:t})},openDelete(n,o){!function({line_number:n,ip:o,onConfirm:l}){t();const d=document.getElementById(e["delete"]),a=bootstrap.Modal.getOrCreateInstance(d,{backdrop:!0,keyboard:!0}),i=document.getElementById(`${e["delete"]}-text`),s=document.getElementById(`${e["delete"]}-confirm`);i.textContent=`Are you sure you want to delete line #${n} (${o})?`,s.onclick=()=>{try{"function"==typeof l&&l({line_number:n}),a.hide()}catch(e){console.error("[ipModal] delete confirm error:",e)}},a.show()}({...n,onConfirm:o})}}}();